---

title: Step

keywords: fastai
sidebar: home_sidebar

summary: "*Incremental Collaborative Filtering* algorithms."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/step.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step-Base">Step Base<a class="anchor-link" href="#Step-Base">&#182;</a></h2><p>This class defines the interface that every <a href="/cf_step/step#Step"><code>Step</code></a> module should implement. Namely, each class should implement five methods:</p>
<ul>
<li><code>batch_fit</code>: To support batch training</li>
<li><code>step</code>: To support incremental learning</li>
<li><code>predict</code>: To offer recommendations</li>
<li><code>save</code>: To save the model parameters</li>
<li><code>load</code>: To load the model parameters</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StepBase" class="doc_header"><code>class</code> <code>StepBase</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StepBase</code>()</p>
</blockquote>
<p>Defines the interface that all step models here expose.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step">Step<a class="anchor-link" href="#Step">&#182;</a></h2><p>The step class implements the basic <em>Incremental Collaborative Filtering</em> recommender system.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Step" class="doc_header"><code>class</code> <code>Step</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L46" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Step</code>(<strong><code>model</code></strong>:<code>Module</code>, <strong><code>objective</code></strong>:<code>Callable</code>, <strong><code>optimizer</code></strong>:<code>Callable</code>, <strong><code>conf_func</code></strong>:<code>Callable</code>=<em><code>'&lt;lambda&gt;'</code></em>) :: <a href="/cf_step/step#StepBase"><code>StepBase</code></a></p>
</blockquote>
<p>Incremental and batch training of recommender systems.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Arguments:</p>
<ul>
<li>model (torch.nn.Module): The neural network architecture</li>
<li>objective (Callable): The objective function</li>
<li>optimizer (Callable): The method used to optimize the objective function. Usually a <code>torch.optim</code> loss function</li>
<li>conf_func (Callable): A method that converts implicit ratings to confidence scores  </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Step.batch_fit" class="doc_header"><code>Step.batch_fit</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Step.batch_fit</code>(<strong><code>data_loader</code></strong>:<code>DataLoader</code>, <strong><code>epochs</code></strong>:<code>int</code>=<em><code>1</code></em>)</p>
</blockquote>
<p>Trains the model on a batch of user-item interactions.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Step.step" class="doc_header"><code>Step.step</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L81" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Step.step</code>(<strong><code>user</code></strong>:<code>tensor</code>, <strong><code>item</code></strong>:<code>tensor</code>, <strong><code>rating</code></strong>:<code>tensor</code>=<em><code>None</code></em>, <strong><code>preference</code></strong>:<code>tensor</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Trains the model incrementally.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Step.predict" class="doc_header"><code>Step.predict</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Step.predict</code>(<strong><code>user</code></strong>:<code>tensor</code>, <strong><code>k</code></strong>:<code>int</code>=<em><code>10</code></em>)</p>
</blockquote>
<p>Recommends the top-k items to a specific user.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Step.save" class="doc_header"><code>Step.save</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L101" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Step.save</code>(<strong><code>path</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Saves the model parameters to the given path.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Step.load" class="doc_header"><code>Step.load</code><a href="https://github.com/dpoulopoulos/cf_step/tree/master/cf_step/step.py#L105" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Step.load</code>(<strong><code>path</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Loads the model parameters from a given path.</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

