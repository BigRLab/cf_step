---

title: CF STEP - Incremental Collaborative Filtering

keywords: fastai
sidebar: home_sidebar

summary: "Incremental learning for recommender systems"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CF STEP is an open-source library, written in python, that enables fast implementation of incremental learning recommender systems. The library is a by-product of the reasearch project <a href="https://clouddb.eu/">CloudDBAppliance</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run <code>pip install cf-step</code> to install the library in your environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this example, we will use the popular <a href="https://grouplens.org/datasets/movielens/">movielens</a> dataset. The dataset has collected and made available rating data sets from the <a href="http://movielens.org">MovieLens</a> web site. The data sets were collected over various periods of time, depending on the size of the set.</p>
<p>First let us load the data in a pandas <code>DataFrame</code>. We assume that the reader has downloaded the 1m movielense dataset and have unziped it in the <code>/tmp</code> folder.</p>
<blockquote><p>To avoid creating a user and movie vocabularies we turn each user and movie to a categorical feature and use the pandas convenient cat attribute to get the codes</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>

<span class="c1"># load the data</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
<span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/tmp/ratings.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">col_names</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="c1"># transform users and movies to categorical features</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># use the codes to avoid creating separate vocabularies</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">ratings_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>0</td>
      <td>1104</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>0</td>
      <td>639</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>0</td>
      <td>853</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>0</td>
      <td>3177</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>0</td>
      <td>2162</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the codes we can see how many users and movies are in the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">n_users</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">n_movies</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are </span><span class="si">{n_users}</span><span class="s1"> unique users and </span><span class="si">{n_movies}</span><span class="s1"> unique movies in the movielens dataset.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 6040 unique users and 3706 unique movies in the movielens dataset.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will sort the data by Timestamp so as to simulate streaming events.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/cf_step/step#Step"><code>Step</code></a> model supports only positive feedback. Thus, we will consider a rating of 5 as positive feedback and discard any other. We want to identify likes with <code>1</code> and dislikes with <code>0</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="c1"># more than 4 -&gt; 1, less than 5 -&gt; 0</span>
<span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># keep only ones and discard the others</span>
<span class="n">data_df_cleaned</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
      <th>preference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>999873</th>
      <td>6040</td>
      <td>593</td>
      <td>5</td>
      <td>956703954</td>
      <td>6039</td>
      <td>579</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1000192</th>
      <td>6040</td>
      <td>2019</td>
      <td>5</td>
      <td>956703977</td>
      <td>6039</td>
      <td>1839</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999920</th>
      <td>6040</td>
      <td>213</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>207</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999967</th>
      <td>6040</td>
      <td>3111</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>2895</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999971</th>
      <td>6040</td>
      <td>2503</td>
      <td>5</td>
      <td>956704191</td>
      <td>6039</td>
      <td>2309</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Following, let us initialize out model with a database connection. For everything else (e.g. <code>learning rate</code>, <code>optimizer</code>, <code>loss function</code> etc.) we will use the defaults.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">SimpleCF</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">std</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pred</span><span class="p">,</span> <span class="n">targ</span><span class="p">:</span> <span class="n">targ</span> <span class="o">-</span> <span class="n">pred</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, let us get 1% of the data to fit the model for bootstrapping and create the Pytorch Dataset that we will use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">pct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bootstrapping_data</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="p">[:</span><span class="n">pct</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sub-classing the <em>Pytorch</em> Dataset class, we will create a dataset from our Dataframe. We extract four elements:</p>
<ul>
<li>The user code</li>
<li>The movie code</li>
<li>The rating</li>
<li>The preference</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="k">class</span> <span class="nc">MovieLens</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
        <span class="n">preference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
        <span class="k">return</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">preference</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the Pytorch Dataset and DataLoader that we will use. Batch size should always be <code>1</code> for online training.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">MovieLens</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="p">)</span>
<span class="n">data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now use the <em>batch_fit()</em> method of the <em>Step</em> trainer to bootstrap our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">batch_fit</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 89/89 [00:04&lt;00:00, 20.40it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, to simulate streaming we get the remaining data and create a different data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_step</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_df_step</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># create the DataLoader</span>
<span class="n">stream_data_set</span> <span class="o">=</span> <span class="n">MovieLens</span><span class="p">(</span><span class="n">data_df_step</span><span class="p">)</span>
<span class="n">stream_data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">stream_data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simulate the stream...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># we keep only the top 10 recommendations</span>
<span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">known_users</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">):</span>
        <span class="n">itr</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="ow">in</span> <span class="n">known_users</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
            
        <span class="n">known_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 181048/181048 [58:28&lt;00:00, 51.60it/s] 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last but not least, we visualize the results of the recall@10 metric, using a moving average window of 5k elements.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">avgs</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">recalls</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recall@10&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Metric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avgs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7eff0bc4e460&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, save the model's weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>cf_step  index.ipynb  metrics.ipynb  networks.ipynb  step.ipynb  utils.ipynb
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;artefacts&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_step.pt&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-17-f0563e457889&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># local</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>model<span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span>os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;artefacts&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;positive_step.pt&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Projects/cf_step/nbs/cf_step/step.py</span> in <span class="ansi-cyan-fg">save</span><span class="ansi-blue-fg">(self, path)</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span>     <span class="ansi-green-fg">def</span> save<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span>         <span class="ansi-blue-fg">&#34;&#34;&#34;Saves the model parameters to the given path.&#34;&#34;&#34;</span>
<span class="ansi-green-fg">--&gt; 117</span><span class="ansi-red-fg">         </span>torch<span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">.</span>state_dict<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    118</span> 
<span class="ansi-green-intense-fg ansi-bold">    119</span>     <span class="ansi-green-fg">def</span> load<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/cf_step/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ansi-cyan-fg">save</span><span class="ansi-blue-fg">(obj, f, pickle_module, pickle_protocol, _use_new_zipfile_serialization)</span>
<span class="ansi-green-intense-fg ansi-bold">    325</span>             <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    326</span> 
<span class="ansi-green-fg">--&gt; 327</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">with</span> _open_file_like<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;wb&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> opened_file<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    328</span>         _legacy_save<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">,</span> opened_file<span class="ansi-blue-fg">,</span> pickle_module<span class="ansi-blue-fg">,</span> pickle_protocol<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    329</span> 

<span class="ansi-green-fg">~/anaconda3/envs/cf_step/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ansi-cyan-fg">_open_file_like</span><span class="ansi-blue-fg">(name_or_buffer, mode)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span> <span class="ansi-green-fg">def</span> _open_file_like<span class="ansi-blue-fg">(</span>name_or_buffer<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    211</span>     <span class="ansi-green-fg">if</span> _is_path<span class="ansi-blue-fg">(</span>name_or_buffer<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 212</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> _open_file<span class="ansi-blue-fg">(</span>name_or_buffer<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    214</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">&#39;w&#39;</span> <span class="ansi-green-fg">in</span> mode<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/cf_step/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, name, mode)</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span> <span class="ansi-green-fg">class</span> _open_file<span class="ansi-blue-fg">(</span>_opener<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    192</span>     <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 193</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span>_open_file<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>open<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    194</span> 
<span class="ansi-green-intense-fg ansi-bold">    195</span>     <span class="ansi-green-fg">def</span> __exit__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;artefacts/positive_step.pt&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

