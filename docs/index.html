---

title: CF STEP - Incremental Collaborative Filtering

keywords: fastai
sidebar: home_sidebar

summary: "Incremental learning for recommender systems"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CF STEP is an open-source library, written in python, that enables fast implementation of incremental learning recommender systems. The library is a by-product of the reasearch project <a href="https://clouddb.eu/">CloudDBAppliance</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run <code>pip install cf-step</code> to install the library in your environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this example, we will use the popular <a href="https://grouplens.org/datasets/movielens/">movielens</a> dataset. The dataset has collected and made available rating data sets from the <a href="http://movielens.org">MovieLens</a> web site. The data sets were collected over various periods of time, depending on the size of the set.</p>
<p>First let us load the data in a pandas <code>DataFrame</code>. We assume that the reader has downloaded the 1m movielense dataset and have unziped it in the <code>/tmp</code> folder.</p>
<blockquote><p>To avoid creating a user and movie vocabularies we turn each user and movie to a categorical feature and use the pandas convenient cat attribute to get the codes</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>

<span class="c1"># load the data</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
<span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/tmp/ratings.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">col_names</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="c1"># transform users and movies to categorical features</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># use the codes to avoid creating separate vocabularies</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">ratings_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>0</td>
      <td>1104</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>0</td>
      <td>639</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>0</td>
      <td>853</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>0</td>
      <td>3177</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>0</td>
      <td>2162</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the codes we can see how many users and movies are in the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">n_users</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">n_movies</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are </span><span class="si">{n_users}</span><span class="s1"> unique users and </span><span class="si">{n_movies}</span><span class="s1"> unique movies in the movielens dataset.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 6040 unique users and 3706 unique movies in the movielens dataset.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will sort the data by Timestamp so as to simulate streaming events.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/cf_step/step#Step"><code>Step</code></a> model supports only positive feedback. Thus, we will consider a rating of 5 as positive feedback and discard any other. We want to identify likes with <code>1</code> and dislikes with <code>0</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="c1"># more than 4 -&gt; 1, less than 5 -&gt; 0</span>
<span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># keep only ones and discard the others</span>
<span class="n">data_df_cleaned</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
      <th>preference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>999873</th>
      <td>6040</td>
      <td>593</td>
      <td>5</td>
      <td>956703954</td>
      <td>6039</td>
      <td>579</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1000192</th>
      <td>6040</td>
      <td>2019</td>
      <td>5</td>
      <td>956703977</td>
      <td>6039</td>
      <td>1839</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999920</th>
      <td>6040</td>
      <td>213</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>207</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999967</th>
      <td>6040</td>
      <td>3111</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>2895</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999971</th>
      <td>6040</td>
      <td>2503</td>
      <td>5</td>
      <td>956704191</td>
      <td>6039</td>
      <td>2309</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Following, let us initialize out model with a database connection. For everything else (e.g. <code>learning rate</code>, <code>optimizer</code>, <code>loss function</code> etc.) we will use the defaults.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">SimpleCF</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">std</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pred</span><span class="p">,</span> <span class="n">targ</span><span class="p">:</span> <span class="n">targ</span> <span class="o">-</span> <span class="n">pred</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, let us get 1% of the data to fit the model for bootstrapping and create the Pytorch Dataset that we will use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">pct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bootstrapping_data</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="p">[:</span><span class="n">pct</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will create a dataset from our Dataframe. We extract four elements:</p>
<ul>
<li>The user code</li>
<li>The movie code</li>
<li>The rating</li>
<li>The preference</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_code&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span>

<span class="n">data_set</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> 
                         <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the Pytorch Dataset and DataLoader that we will use. Batch size should always be <code>1</code> for online training.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="c1"># data_set = MovieLens(bootstrapping_data)</span>
<span class="n">data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now use the <em>batch_fit()</em> method of the <em>Step</em> trainer to bootstrap our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">batch_fit</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 89/89 [00:00&lt;00:00, 131.18it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, to simulate streaming we get the remaining data and create a different data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_step</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_df_step</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># create the DataLoader</span>
<span class="n">stream_data_set</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">data_df_step</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> 
                                <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">data_df_step</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">stream_data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">stream_data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simulate the stream...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># we keep only the top 10 recommendations</span>
<span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">known_users</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">preferences</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">):</span>
        <span class="n">itr</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="n">user</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">rtng</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">pref</span> <span class="o">=</span> <span class="n">preferences</span>
        
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="ow">in</span> <span class="n">known_users</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
            
        <span class="n">known_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 181048/181048 [13:00&lt;00:00, 231.85it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last but not least, we visualize the results of the recall@10 metric, using a moving average window of 5k elements.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">avgs</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">recalls</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recall@10&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Metric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avgs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f1c6381cfd0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, save the model's weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;artefacts&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_step.pt&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

