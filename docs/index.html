---

title: CF STEP - Incremental Collaborative Filtering

keywords: fastai
sidebar: home_sidebar

summary: "Incremental learning for recommender systems"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CF STEP is an open-source library, written in python, that enables fast implementation of incremental learning recommender systems. The library is a by-product of the reasearch project <a href="https://clouddb.eu/">CloudDBAppliance</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run <code>pip install cf-step</code> to install the library in your environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this example, we will use the popular <a href="https://grouplens.org/datasets/movielens/">movielens</a> dataset. The dataset has collected and made available rating data sets from the <a href="http://movielens.org">MovieLens</a> web site. The data sets were collected over various periods of time, depending on the size of the set.</p>
<p>First let us load the data in a pandas <code>DataFrame</code>. We assume that the reader has downloaded the 1m movielense dataset and have unziped it in the <code>/tmp</code> folder.</p>
<blockquote><p>To avoid creating a user and movie vocabularies we turn each user and movie to a categorical feature and use the pandas convenient cat attribute to get the codes</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>

<span class="c1"># load the data</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_id&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
<span class="n">ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/tmp/ratings.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">col_names</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="c1"># transform users and movies to categorical features</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># use the codes to avoid creating separate vocabularies</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">ratings_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>0</td>
      <td>1104</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
      <td>0</td>
      <td>639</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
      <td>0</td>
      <td>853</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
      <td>0</td>
      <td>3177</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
      <td>0</td>
      <td>2162</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the codes we can see how many users and movies are in the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">n_users</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">n_movies</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are </span><span class="si">{n_users}</span><span class="s1"> unique users and </span><span class="si">{n_movies}</span><span class="s1"> unique movies in the movielens dataset.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 6040 unique users and 3706 unique movies in the movielens dataset.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will sort the data by Timestamp so as to simulate streaming events.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">ratings_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/cf_step/step#Step"><code>Step</code></a> model supports only positive feedback. Thus, we will consider a rating of 5 as positive feedback and discard any other. We want to identify likes with <code>1</code> and dislikes with <code>0</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="c1"># more than 4 -&gt; 1, less than 5 -&gt; 0</span>
<span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># keep only ones and discard the others</span>
<span class="n">data_df_cleaned</span> <span class="o">=</span> <span class="n">data_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>user_code</th>
      <th>movie_code</th>
      <th>preference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>999873</th>
      <td>6040</td>
      <td>593</td>
      <td>5</td>
      <td>956703954</td>
      <td>6039</td>
      <td>579</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1000192</th>
      <td>6040</td>
      <td>2019</td>
      <td>5</td>
      <td>956703977</td>
      <td>6039</td>
      <td>1839</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999920</th>
      <td>6040</td>
      <td>213</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>207</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999967</th>
      <td>6040</td>
      <td>3111</td>
      <td>5</td>
      <td>956704056</td>
      <td>6039</td>
      <td>2895</td>
      <td>1</td>
    </tr>
    <tr>
      <th>999971</th>
      <td>6040</td>
      <td>2503</td>
      <td>5</td>
      <td>956704191</td>
      <td>6039</td>
      <td>2309</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Following, let us initialize out model with a database connection. For everything else (e.g. <code>learning rate</code>, <code>optimizer</code>, <code>loss function</code> etc.) we will use the defaults.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">SimpleCF</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">std</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pred</span><span class="p">,</span> <span class="n">targ</span><span class="p">:</span> <span class="n">targ</span> <span class="o">-</span> <span class="n">pred</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Step</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">objective</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, let us get 1% of the data to fit the model for bootstrapping and create the Pytorch Dataset that we will use.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">pct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bootstrapping_data</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="p">[:</span><span class="n">pct</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sub-classing the <em>Pytorch</em> Dataset class, we will create a dataset from our Dataframe. We extract four elements:</p>
<ul>
<li>The user code</li>
<li>The movie code</li>
<li>The rating</li>
<li>The preference</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="k">class</span> <span class="nc">MovieLens</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
    
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;user_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
        <span class="n">preference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;preference&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
        <span class="k">return</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="n">preference</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the Pytorch Dataset and DataLoader that we will use. Batch size should always be <code>1</code> for online training.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">MovieLens</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="p">)</span>
<span class="n">data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">i</span> <span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data_loader</span><span class="p">))</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">i</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span>

<span class="n">res</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([512, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now use the <em>batch_fit()</em> method of the <em>Step</em> trainer to bootstrap our model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">batch_fit</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 89/89 [00:05&lt;00:00, 16.99it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, to simulate streaming we get the remaining data and create a different data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">bootstrapping_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">data_df_step</span> <span class="o">=</span> <span class="n">data_df_step</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_df_step</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># create the DataLoader</span>
<span class="n">stream_data_set</span> <span class="o">=</span> <span class="n">MovieLens</span><span class="p">(</span><span class="n">data_df_step</span><span class="p">)</span>
<span class="n">stream_data_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">stream_data_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simulate the stream...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># we keep only the top 10 recommendations</span>
<span class="n">recalls</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">known_users</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stream_data_loader</span><span class="p">):</span>
        <span class="n">itr</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="ow">in</span> <span class="n">known_users</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">recalls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">rtng</span><span class="p">,</span> <span class="n">pref</span><span class="p">)</span>
            
        <span class="n">known_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 181048/181048 [1:00:25&lt;00:00, 49.94it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last but not least, we visualize the results of the recall@10 metric, using a moving average window of 5k elements.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">avgs</span> <span class="o">=</span> <span class="n">moving_avg</span><span class="p">(</span><span class="n">recalls</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Recall@10&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Metric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">avgs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f811f94a730&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, save the model's weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># local</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;artefacts&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_step.pt&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

